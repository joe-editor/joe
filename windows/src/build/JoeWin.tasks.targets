<?xml version="1.0" encoding="utf-8"?>
<!--
   This file is part of Joe's Own Editor for Windows.
   Copyright (c) 2015 John J. Jordan.
 
   Joe's Own Editor for Windows is free software: you can redistribute it
   and/or modify it under the terms of the GNU General Public License as
   published by the Free Software Foundation, either version 2 of the
   License, or (at your option) any later version.
 
   Joe's Own Editor for Windows is distributed in the hope that it will
   be useful, but WITHOUT ANY WARRANTY; without even the implied warranty
   of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
 
   You should have received a copy of the GNU General Public License
   along with Joe's Own Editor for Windows.  If not, see
   <http://www.gnu.org/licenses/>.
-->

<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <_CodeTaskFactoryAssembly Condition="'$(MSBuildToolsVersion)' == '4.0'">$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll</_CodeTaskFactoryAssembly>
    <_CodeTaskFactoryAssembly Condition="'$(MSBuildToolsVersion)' != '4.0'">$(MSBuildToolsPath)\Microsoft.Build.Tasks.Core.dll</_CodeTaskFactoryAssembly>
  </PropertyGroup>
  
  <!-- UNIX to DOS copy task -->
  <UsingTask TaskName="CopyConvertLF" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <SourceFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="True" />
      <DestinationFolder ParameterType="System.String" Required="False" />
      <DestinationFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="False" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Code Type="Fragment" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\CopyConvertLF.cs" />
    </Task>
  </UsingTask>
  
  <!-- Build .rc files from .spec files -->
  <UsingTask TaskName="JWGenerateResources" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <Specs ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="True" />
      <FileLocation ParameterType="System.String" Required="True" />
      <OutputFile ParameterType="System.String" Required="True" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Using Namespace="System.IO.Compression" />
      <Using Namespace="System.Collections.Generic" />
      <Using Namespace="System.Linq" />
      <Code Type="Fragment" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\GenerateResources.cs" />
    </Task>
  </UsingTask>

  <UsingTask TaskName="JWDeflateFiles" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <InputFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="True" />
      <OutputDirectory ParameterType="System.String" Required="True" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Using Namespace="System.IO.Compression" />
      <Using Namespace="System.Collections.Generic" />
      <Using Namespace="System.Linq" />
      <Code Type="Fragment" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\DeflateFiles.cs" />
    </Task>
  </UsingTask>

  <UsingTask TaskName="JWVersion" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <OutputDirectory ParameterType="System.String" Required="True" />
      <VersionNumber ParameterType="System.String" Required="True" />
      <VersionDesignation ParameterType="System.String" Required="False" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Using Namespace="System.Collections.Generic" />
      <Using Namespace="System.Linq" />
      <Using Namespace="System.Diagnostics" />
      <Code Type="Method" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\Version.cs" />
    </Task>
  </UsingTask>

  <UsingTask TaskName="SqueezePO" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <SourceFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="True" />
      <DestinationFolder ParameterType="System.String" Required="False" />
      <DestinationFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="False" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Using Namespace="System.Collections.Generic" />
      <Using Namespace="System.Linq" />
      <Using Namespace="System.Text" />
      <Code Type="Method" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\SqueezePO.cs" />
    </Task>
  </UsingTask>

  <UsingTask TaskName="SqueezeJSF" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <SourceFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="True" />
      <DestinationFolder ParameterType="System.String" Required="False" />
      <DestinationFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="False" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Using Namespace="System.Collections.Generic" />
      <Using Namespace="System.Linq" />
      <Using Namespace="System.Text" />
      <Code Type="Method" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\SqueezeJSF.cs" />
    </Task>
  </UsingTask>

  <UsingTask TaskName="SqueezeRC" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <SourceFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="True" />
      <DestinationFolder ParameterType="System.String" Required="False" />
      <DestinationFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="False" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Using Namespace="System.Collections.Generic" />
      <Using Namespace="System.Linq" />
      <Using Namespace="System.Text" />
      <Code Type="Method" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\SqueezeRC.cs" />
    </Task>
  </UsingTask>

  <UsingTask TaskName="Markdown" TaskFactory="CodeTaskFactory" AssemblyFile="$(_CodeTaskFactoryAssembly)">
    <ParameterGroup>
      <SourceFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="True" />
      <DestinationFolder ParameterType="System.String" Required="False" />
      <DestinationFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="False" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System" />
      <Using Namespace="System.IO" />
      <Using Namespace="System.Collections.Generic" />
      <Using Namespace="System.Configuration" />
      <Using Namespace="System.Linq" />
      <Using Namespace="System.Text" />
      <Using Namespace="System.Text.RegularExpressions" />
      <Code Type="Method" Language="cs" Source="$(MSBuildThisFileDirectory)\tasks\Markdown.cs" />
    </Task>
  </UsingTask>

</Project>
